function str_repeat(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}function sprintf(){var e=0,t,n=arguments[e++],r=[],i,s,o,u,a="";while(n){if(i=/^[^\x25]+/.exec(n))r.push(i[0]);else if(i=/^\x25{2}/.exec(n))r.push("%");else{if(!(i=/^\x25(?:(\d+)\$)?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(n)))throw"Huh ?!";if((t=arguments[i[1]||e++])==null||t==undefined)throw"Too few arguments.";if(/[^s]/.test(i[7])&&typeof t!="number")throw"Expecting number but found "+typeof t;switch(i[7]){case"b":t=t.toString(2);break;case"c":t=String.fromCharCode(t);break;case"d":t=parseInt(t);break;case"e":t=i[6]?t.toExponential(i[6]):t.toExponential();break;case"f":t=i[6]?parseFloat(t).toFixed(i[6]):parseFloat(t);break;case"o":t=t.toString(8);break;case"s":t=(t=String(t))&&i[6]?t.substring(0,i[6]):t;break;case"u":t=Math.abs(t);break;case"x":t=t.toString(16);break;case"X":t=t.toString(16).toUpperCase()}t=/[def]/.test(i[7])&&i[2]&&t>=0?"+"+t:t,o=i[3]?i[3]=="0"?"0":i[3].charAt(1):" ",u=i[5]-String(t).length-a.length,s=i[5]?str_repeat(o,u):"",r.push(a+(i[4]?t+s:s+t))}n=n.substring(i[0].length)}return r.join("")}$(window).load(function(){var e=$("form").validate({invalidHandler:function(e,t){var n=t.numberOfInvalids();if(n){var r=n===1?"You missed 1 field. It has been highlighted.":"You missed "+n+" fields. They have been highlighted.";$(".box .content").removeAlertBoxes(),$(".box .content").alertBox(r,{type:"warning",icon:!0,noMargin:!1}),$(".box .content .alert").css({width:"",margin:"0 0 5px",borderLeft:"none",borderRight:"none",borderRadius:0})}else $(".box .content").removeAlertBoxes()},showErrors:function(e,t){this.defaultShowErrors();var n=this;$.each(t,function(){var e=$(this.element),t=e.parent().find("label.error").hide();t.addClass("red"),t.css("width",""),e.trigger("labeled"),t.fadeIn()})}});$(".beforeLoading").removeClass("beforeLoading"),$(".enrolled").removeClass("enrolled").addClass("derolled")});var run=function(){var e=$(".time.running"),t=e.find("span:nth-child(1)"),n=e.find("span:nth-child(2)"),r=e.find("span:nth-child(3)"),i=parseInt(e.find("span:nth-child(3)").text(),10),s=parseInt(e.find("span:nth-child(2)").text(),10);r.text(function(e,t){return str=parseInt(t,10)+1,str>0&&str<10?str="0"+str:str>=60&&(str="00"),str}),i==0&&n.text(function(e,t){return str=parseInt(t,10)+1,str>0&&str<10?str="0"+str:str>=60&&(str="00"),str}),s==0&&i==0&&t.text(function(e,t){return str=parseInt(t,10)+1,str>0&&str<10?str="0"+str:str>=24&&(str="00"),str}),setTimeout("run()",1e3)};$(document).ready(function(){run();var e=$("div.grid_6").outerHeight();$("#stats_container").css({height:parseInt(e),overflow:"hidden"}),$(document).keydown(function(t){el=$("div.en, div.cn"),position=el.position(),t.keyCode==40?(t.preventDefault(),$("div.grid_6").removeClass("isInitialPosition").css({"-moz-transform":"translateY(-"+e+"px)","-webkit-transform":"translateY(-"+e+"px)","-o-transform":"translateY(-"+e+"px)","-ms-transform":"translateY(-"+e+"px)"})):t.keyCode==38&&(t.preventDefault(),$("div.grid_6").addClass("isInitialPosition").removeAttr("style"))}),$("#accordion").accordion(),$(window).resize(),toPull=new Array,$("#stats_container .stats-list a").each(function(){typeof $(this).attr("id")!="undefined"&&toPull.push($(this).attr("id"))}),$.ajax({url:"/ajax/dashboard",type:"POST",data:{values:toPull},success:function(e){window.p=e;var t=["en","cn","ru","tw"];localStorage&&localStorage.stat===null&&localStorage.setItem("stats",JSON.stringify(e));for(k in t){var n=t[k],r=0;for(stat in e[n]){var i=e[n][stat][0].day,s=typeof e[n][stat][0].anteday=="undefined"?"-":e[n][stat][0].anteday,o=e[n][stat][0].week,u=typeof e[n][stat][0].anteweek=="undefined"?"-":e[n][stat][0].anteweek,a=e[n][stat][0].month,f=typeof e[n][stat][0].antemonth=="undefined"?"-":e[n][stat][0].antemonth;r+=e[n][stat][0].day!=null?parseInt(e[n][stat][0].day):0,trend=s>i?"down":s<i?"up":"equal",$("#stats_container ."+n+" #"+stat+" span:nth-child(1)").addClass(trend).html(i+"<small>"+s+"</small>"),trend=u>o?"down":u<o?"up":"equal",$("#stats_container ."+n+" #"+stat+" span:nth-child(2)").addClass(trend).html(o+"<small>"+u+"</small>"),trend=f>a?"down":f<a?"up":"equal",$("#stats_container ."+n+" #"+stat+" span:nth-child(3)").addClass(trend).html(a+"<small>"+f+"</small>")}var l="<span class='icon'></span>Today "+r+" people registered.";$("#"+n+"_stat .info").html(l)}}})}),$(".notificationsSend input[type=submit]").click(function(){if(ws){var e={name:$(".toolcaption span").text(),text:$(".notificationsSend textarea").val()},t=JSON.stringify(e);ws.send(t)}else $.jGrowl("no connection to the web socket server",{theme:"information",life:3e3});$(".notificationsSend textarea").val("")}),window.hasOwnProperty("localStorage")||(window.localStorage={_data:{},setItem:function(e,t){return this._data[e]=String(t)},getItem:function(e){return this._data.hasOwnProperty(e)?this._data[e]:undefined},removeItem:function(e){return delete this._data[e]},clear:function(){return this._data={}}}),localStorage&&(Storage.prototype.setObj=function(e,t){return this.setItem(e,JSON.stringify(t))},Storage.prototype.getObj=function(e){return JSON.parse(this.getItem(e))}),Function.prototype.bind==null&&(Function.prototype.bind=function(e){function t(t){var n=this;if(1<arguments.length){var r=e.call(arguments,1);return function(){return n.apply(t,arguments.length?r.concat(e.call(arguments)):r)}}return function(){return arguments.length?n.apply(t,arguments):n.call(t)}}return t}(Array.prototype.slice)),function(e){function u(e){e.requestFullScreen?e.requestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen&&e.webkitRequestFullScreen()}e.extend(e.fn,{contains:function(t){var n=!1;return typeof t=="string"?n=e(this).has(t).length!=0:"nodeType"in t[0]&&(n=e.contains(e(this),t)),n}}),function(){e.fn.validate&&(e.validator.addMethod("tableExists",function(t,n){return isSuccess=!1,e.ajax({url:"/ajax/table_exists/"+t,async:!1,success:function(e){isSuccess=!!e}}),this.optional(n)||isSuccess},"The table doesn't exists"),e.validator.addMethod("uri",function(e,t){return this.optional(t)||e.match(/^[a-zA-Z_\-]+$/)},"The URI can only be alphabetic with no space, dashes and underscores are allowed"),e("form.validate").each(function(){var t=e(this).validate({ignore:"input:hidden:not(:checkbox):not(:radio)",showErrors:function(t,n){this.defaultShowErrors();var r=this;e.each(n,function(){var t=e(this.element),n=t.parent().find("label.error").hide();n.length||(n=t.parent().parent().find("label.error")),t.is(":not(:checkbox):not(:radio):not(select):not([type=file])")&&(n.addClass("red"),n.css("width",""),t.trigger("labeled")),n.fadeIn()})},errorPlacement:function(t,n){n.is(":not(:checkbox):not(:radio):not(select):not([type=file])")?t.insertAfter(n):n.is("select")?t.appendTo(n.parent()):n.is("[type=file]")?t.insertAfter(n.parent()):t.appendTo(n.parent().parent()),e.browser.msie&&t.wrap('<div class="error-wrap" />')}});e(this).find("input[type=reset]").click(function(){t.resetForm()})})),e("input, textarea").bind("labeled",function(){e(this).parent().find("label.error").css("width",parseFloat(e(this).css("innerWidth"))-10+"px")}),e.fn.checkbox&&(e('input[type="checkbox"]').checkbox({cls:"checkbox",empty:"img/sprites/forms/checkboxes/empty.png"}),e("input:radio").checkbox({cls:"radio-button",empty:"img/sprites/forms/checkboxes/empty.png"})),e.fn.chosen&&(e("select.deselect").chosen({allow_single_deselect:!0}),e("select:not[.deselect]").chosen(),e(".chzn-container").addClass("_100"),e(window).resize(function(){e(".chzn-container").each(function(){var t=e(this),n=e("#"+t.attr("id").replace("_chzn",""));t.css("width",parseFloat(n.show().css("widthExact"))+3+"px"),n.hide()})})),e.fn.customFileInput&&e.fn.ellipsis&&e("input[type=file]").customFileInput(),e.fn.placeholder&&e("input, textarea").placeholder();if(e.fn.datepicker&&e.fn.datetimepicker&&!e.browser.opera){var t={hourGrid:23,minuteGrid:59};e("input[type=date]").datepicker(e.extend(t,{showButtonPanel:!0})),e("input[type=datetime]").datetimepicker(t),e("input[type=time]").not("[data-timeformat=12]").timepicker(t),e("input[type=time][data-timeformat=12]").timepicker(e.extend(t,{ampm:!0})),e("input.hasDatepicker[data-date-relative]").each(function(){var t=e(this).attr("id").split(" "),n,r=this;e.each(t,function(){if(this.indexOf("dp")==0||e("label[for="+this+"]").length)n=this});if(!n)throw"Invalid form";e(this).attr("type")=="date"?(e(this).datepicker("option","defaultDate",null),e(".ui-datepicker-today",e.datepicker._getInst(e("#"+n)[0]).dpDiv).click()):e.datepicker._gotoToday("#"+n)})}!e.browser.opera&&e.fn.miniColors&&e("input[type=color]").miniColors()}(),function(){e(".alert").find(".hide").click(function(t){t.preventDefault(),e(this).parent().parent().slideUp()}),e(".box").find(".header").children("span").click(function(){var t=e(this),n=t.parents(".box"),r=n.find(".content"),i=n.find(".actions");r.is(":visible")?(r.slideToggle("normal","easeInOutCirc",function(){n.toggleClass("closed"),e(window).resize()}),i.slideToggle("normal","easeInOutCirc")):(r.slideToggle("normal","easeInOutCirc"),i.slideToggle("normal","easeInOutCirc",function(){e(window).resize()}),n.toggleClass("closed"))}),e(".box").find(".header").each(function(){var t=e(this);t.contains("img")||t.addClass("no-icon")}),e(".box").each(function(){var t=e(this),n=t.find(".content");t.contains(".actions")&&n.addClass("with-actions"),t.find(".header").hasClass("grey")&&n.addClass("grey"),!t.contains(".header")&&n.addClass("no-header")})}(),function(){if(e.fn.equalHeights){var t=function(t,n){var r=e(".steps li",n).length;return t<1||t>r?!0:(e(".wizard").find(".steps").find("li").removeClass("current").eq(t-1).addClass("current"),n.data("step",parseInt(t)),n.find(".wiz_page").stop(!0,!0).hide("fade"),n.find(".step_"+t).stop(!0,!0).delay(400).show("fade"),!1)},n=function(n,r){var i=e(n).parents(".wizard"),s=i.data("step");t(s+r,i)};e(".wizard").find(".steps").find("a").click(function(){var n=e(this).attr("href").replace("#step_",""),r=e(this).parents(".wizard");t(n,r)});var r=e(".wizard").find(".actions");r.find(".prev").click(function(){n(this,-1)}),r.find(".next").click(function(){n(this,1)});var i=1,s=window.location.hash;if(s.indexOf("#step-")==0){var o=parseInt(s.substr(1).replace("step-",""));i=o}e(".wizard").each(function(){var n=e(this);t(i,n)}),e(".wizard").find(".wiz_page").equalHeights().not(":first").hide()}}(),function(){if(e("aside").length){e("#content-wrapper").css("margin-bottom","0");var t=function(){var n=t;typeof n.height=="undefined"&&(n.height=e(window).height());var r={content:e("#content-wrapper"),header:e("header"),footer:e("footer"),sidebar:e("aside")},i={window:e(window).height(),document:e(document).height(),header:r.header.height(),footer:r.footer.height()},s=n.height-i.window;n.height=e(window).height();var o=i.header+i.footer+1;e.extend(i,{document:e(document).height(),window:e(window).height()}),s>=0&&(r.content.css("height",""),r.sidebar.css("height","")),e.extend(i,{document:e(document).height(),window:e(window).height()}),i.content=i.document-o,r.content.css("height",i.content)};t(),e(window).on("resize orientationchange",t),e(document).resize(t),e.resize&&(e.resize.delay=200,e.resize.throttleWindow=!1)}}(),e.browser.msie?(e("html").addClass("ie"),e("input[type=submit],input[type=reset],button").each(function(){e(this).wrap('<div class="button-wrap" />')}),e(".userinfo .info a").wrap('<div class="info-wrap" />')):e.browser.opera?e("html").addClass("opera"):e.browser.webkit&&e("html").addClass("webkit"),function(){e.fn.tipsy&&(e("a[rel=tooltip]").tipsy({fade:!0}),e("a[rel=tooltip-bottom]").tipsy({fade:!0}),e("a[rel=tooltip-right]").tipsy({fade:!0,gravity:"w"}),e("a[rel=tooltip-top]").tipsy({fade:!0,gravity:"s"}),e("a[rel=tooltip-left]").tipsy({fade:!0,gravity:"e"}),e("a[rel=tooltip-html]").tipsy({fade:!0,html:!0}),e("div[rel=tooltip]").tipsy({fade:!0}))}(),function(){var t=!1,n=t?"themed":"blue";try{var r=e("#nav_main").find("li.current").find("img");r.attr("src",r.attr("src").replace("dark",n))}catch(i){}e("#nav_main").find("li").not(".current").find("ul").hide(),e("#nav_main").children("li").children('a[href="#"]').click(function(){var t=e(this),r=t.parent(),i=r.parent();try{var s=t.parents("ul").children(".current").find("img");s.attr("src",s.attr("src").replace(n,"dark"))}catch(o){}i.children().removeClass("current"),r.addClass("current");try{s=t.children("img"),s.attr("src",s.attr("src").replace("dark",n))}catch(o){}i.find("li").children("ul").fadeOut(150),r.contains("ul")&&r.children("ul").fadeIn(150);var u=t.siblings("ul").outerHeight();return e("#nav_sub").css("height",u),!1})}(),e(".graph").bind("plothover",function(t,n,r){if(r){var i=r.datapoint[0].toFixed(2),s=r.datapoint[1].toFixed(2);e(this).tipsy({fallback:"",followMouse:!0,autoGravity:!0}),e(this).tipsy("setTitle",r.series.label+" is "+s+" at "+i),e(this).tipsy("show")}else e(this).tipsy("hide")}),function(){e.fn.prettyPhoto&&(e(".gallery .action-list").hide(),e(".gallery").children("li").mouseenter(function(){e(this).find(".action-list").animate({width:"show"},250)}),e(".gallery").children("li").mouseleave(function(){e(this).find(".action-list").animate({width:"hide"},250)}),e(".gallery").find("a[rel^='prettyPhoto']").prettyPhoto())}(),function(){var t=function(e){e.stopPropagation()};e(document).click(function(){var t=e(this);e(".toolbox:visible").fadeOut(),e(".toolbar_large").find(".dropdown:visible").each(function(){t.slideUp({easing:"easeInOutCirc"}),t.parent().find(".toolcaption").removeClass("active")})}),e(".toolbutton").each(function(){var n=e(this);n.next().hasClass("toolbox")&&(n.click(function(n){t(n),e(this).next().fadeToggle()}),n.next().click(t),n.next().hide())}),e(".toolbar_large").each(function(){var n=e(this),r=n.find(".dropdown");n.find(".toolcaption").css("min-width",r.innerWidth()-2+"px"),n.find(".toolcaption").click(function(i){r.css("width",parseFloat(n.find(".toolcaption").css("width"))+12+"px"),t(i),e(this).toggleClass("active"),r.slideToggle({easing:"easeInOutCirc"}),r.click(t)}),r.hide()})}(),e.jGrowl&&(e.jGrowl.defaults.life=8e3,e.jGrowl.defaults.pool=5),function(){var t=-1,n=e(".activity.fixed.equal").find(".description");n.each(function(){var n=e(this).width();n>t&&(t=n)}),n.each(function(){e(this).width(t)})}(),e(document).ready(function(){e(".alert.slide").length>0&&setTimeout(function(){e(".alert.slide").slideUp(800)},3e3),e('nav a[href="'+document.location.href+'"]').parent().addClass("current").closest("ul").show().closest("li").addClass("current")}),jQuery.fn.topLink=function(t){return t=jQuery.extend({min:1,fadeSpeed:200},t),this.each(function(){var n=e(this);n.hide(),e(window).scroll(function(){e(window).scrollTop()>=t.min?n.fadeIn(t.fadeSpeed):n.fadeOut(t.fadeSpeed)})})},e("#top-link").topLink({min:100,fadeSpeed:800}),e("#top-link").click(function(t){t.preventDefault(),e.scrollTo(0,500)}),e(".suspend input[type=checkbox]").on("change",function(){var t=e(this).parent().siblings(".username").find("a").text();$that=e(this),e(this).is(":checked")?e.ajax({url:"/ajax/block",data:{user_id:t},type:"POST",success:function(n){$that.parent().siblings(".username").find("a").addClass("blocked"),e.jGrowl("User <b>"+t+"</b> has been successfuly blocked for "+n+" minutes",{theme:"success"})}}):e.ajax({url:"ajax/unblock",data:{user_id:t},type:"POST",success:function(n){$that.parent().siblings(".username").find("a").removeClass("blocked"),e.jGrowl("User <b>"+t+"</b> has been successfuly unblocked",{theme:"success"})}})}),e("button.save").click(function(t){t.preventDefault();if(!window.localStorage)alert("localStorage not supported");else{var n=e(this).parent().parent().parent(),r=n.find("#form_subject").val(),s=n.find("#form_content").val(),o=e(".message").data("to"),u=localStorage.getObj("message"),a=new Array;u!=null&&(a=u);var f=!1;for(i in a)message=a[i],message.to==o&&(a[i]={to:o,content:s,subject:r,date:new Date},f=!f);f||a.push({to:o,content:s,subject:r,date:new Date}),localStorage.setObj("message",a),e.jGrowl("Your message has been successfuly saved locally",{theme:"success"})}});if(e(".Controller_Groups.create").length>0){var t=["form_users_index","form_all_read","form_customers_en","form_customers_index","form_filters_lang_use","form_filters_date_use","form_filters_multi_use","form_ajax_dashboard"],n=300,r=t[t.length-1];for(option in t)(function(i){setTimeout(function(){e("#"+t[i]).prop({checked:!0}),t[i]==r&&e.jGrowl("A set of default options has been created",{theme:"information"})},n)})(option),n+=300}var s=function(){var e=document.URL,t=[],n=[];return localStorage.getObj("urls")&&(t=localStorage.getObj("urls",t)),t.push(e),localStorage.setObj("urls",t),t},o=function(t){if(typeof t=="undefined")return;var n="ajax/tables_exists/"+t;e.ajax({url:n,success:function(e){return e}})};e(".fs").on("click",function(){return u(e("#daily")[0]),!1}),e(document).on("show",function(){e("body.login").length<1&&e.ajax({url:"/ajax/session_up",success:function(e){e||location.reload()}})}),e(document).ready(function(){var t=e("#nav_main > li.current ul").outerHeight();e("#nav_sub").css("height",t)}),e(".taskList li").click(function(){e(this).hasClass("checked")?e(this).removeClass("checked"):e(this).addClass("checked")})}(jQuery),$(document).ready(function(){var t,n={all:{country:2,website:7,date:10,hide:[0]},callback:{country:4,website:12,date:13,hide:[0,10,11]},inquiry:{country:4,website:10,date:11,hide:[0,1,8,9]},ib:{country:3,website:16,date:17,hide:[0,8,9,10,11,12,13,14,15]},franchisescheme:{country:3,website:12,date:13,hide:[0,8,9,10,11]},seniorpartner:{country:3,website:12,date:13,hide:[0,8,9,10,11]},whitelabel:{country:3,website:13,date:14,hide:[0,8,9,10,11,12]},small_registration:{country:4,website:10,date:9,hide:[0]},forexblog_ib_registration:{country:"none",website:"none",date:7,hide:[0]},promotions:{country:"none",website:12,date:13,hide:[0,1,2,14]},videoconference:{country:4,website:13,date:16,hide:[0,1,2,10,11,12]},demoaccount:{country:10,website:13,date:15,hide:[0,2,3,4,5,6,7,14]},fb_home:{country:"none",website:6,date:10,hide:[0,3,8]},pay_order_info:{country:"none",website:"none",date:12,hide:[0,11]},cmginfo:{country:"none",website:7,date:9,hide:[0,8]}};t=$("#grid").dataTable({sAjaxSource:"/ajax/tables/"+table,sServerMethod:"POST",bAutoWidth:!1,bSortClasses:!1,bDestroy:!0,bRetrieve:!0,bServerSide:!0,bProcessing:!0,oColVis:{bRestore:!0},aoColumnDefs:[{sClass:"read_only",aTargets:[0]},{bVisible:!1,aTargets:n[table].hide}],sDom:'<"tools"<"tools-left"T><"tools-right"C><"clear">><"top"lf<"clear">>trt<"actions"<"actions-left"i><"actions-right"p>>',aaSorting:[[n[table].date,"desc"]],oLanguage:{sSearch:"Search all columns:",sInfoFiltered:" - filtering from <b>_MAX_</b> records",sProcessing:"Processing on table "+table+"<span id='s1'>.</span><span id='s2'>.</span><span id='s3'>.</span>",sLengthMenu:"_MENU_"},oColReorder:{iFixedColumns:0},aLengthMenu:[[5,10,25,50,100,200],[5,10,25,50,100,200]],iDisplayLength:10,sPaginationType:"full_numbers",oTableTools:{sSwfPath:"/assets/swf/copy_cvs_xls_pdf.swf"},fnRowCallback:function(e,t,n,r){return $(e).attr("id",t[0]),e},fnServerParams:function(e,t){e.push({name:"min",value:$("#min").val()}),e.push({name:"max",value:$("#max").val()}),e.push({name:"language",value:languages}),e.push({name:"langPosition",value:n[table].website})},fnDrawCallback:function(e,t,n){},fnInitComplete:function(e){}}),t.parent().find("select").chosen(),canEdit&&table!="all"&&t.makeEditable({sUpdateURL:"/ajax/updateData/"+table,fnOnEditing:function(e,t,n,r){var i=$(e).val();if(i!=n&&!isNaN(r))return $.jGrowl("Editing row #"+r+" from "+n+" to "+i,{theme:"information"}),!0;if(i==n)return $.jGrowl("Cannot edit row #"+r+" because the entered value is the same as the previous one",{theme:"warning"}),!1;if(isNaN(r))return $.jGrowl("Error with the id, please contact the administrator: jonathan@ikonfx.com",{theme:"warning"}),!1},fnOnEdited:function(e,t,n,r,i,s){e=="failure"?$.jGrowl("Fail editing",{theme:"error"}):$.jGrowl("Successfuly edited the row",{theme:"success"})}}),$(".chosen_lang").change(function(e){var r=e.target.value;n[table].website!="none"&&t.fnFilter(r,n[table].website)});var r=new Array;$("tfoot input").keyup(function(){t.fnFilter(this.value,$(this).attr("data-p"))}),$("tfoot input").each(function(e){r[e]=this.value}),$("tfoot input").focus(function(){this.className=="search_init"&&(this.className="",this.value="")}),$("tfoot input").blur(function(e){this.value==""&&(this.className="search_init",this.value=r[$("tfoot input").index(this)])});var s="";$("#grid tbody tr").live("click",function(){s=t.fnGetData(this),$("span.details, span.delete").remove(),canDelete&&table!="all"?control='<span class="btn delete" id="btnDeleteRow">Delete</span><span class="btn details">[D]etails</span>':control='<span class="btn details">[D]etails</span>',$(this).before(control)}),$(".details").live("click",function(e){e.preventDefault(),$(this).addClass("row_selected").parent().removeClass("row_selected"),$(this).next().addClass("row_selected"),$(this).closest("#contextMenu").data("id")&&(s=t.fnGetData($("#"+$(this).closest("#contextMenu").data("id"))[0])),o()}),$(".delete").live("click",function(e){e.preventDefault();var n=$(this).closest("#contextMenu").data("id")?$(this).closest("#contextMenu").data("id"):s[0],r={id:n,table:table};$(this).addClass("row_selected").parent().removeClass("row_selected"),$(this).nextUntil("tr").next().addClass("row_selected");var i=function(){$.ajax({url:"/ajax/deleteData",data:r,type:"POST",success:function(e){e==1&&($.jGrowl("Row #"+n+" in "+table+" successfully deleted, please be careful when deleting row there is no rollback",{theme:"information"}),t.fnDraw())}}),$.fallr("hide")};$.fallr("show",{buttons:{button1:{text:"Delete",danger:!0,onclick:i},button2:{text:"Cancel",onclick:function(){$.fallr("hide")}}},content:"<p>You are going to delete user #"+n+"?</p>",icon:"error"})}),$(document).keyup(function(e){e.keyCode===68&&$(".row_selected").length>0&&o(),e.keyCode===27&&$("#contextMenu").length>0&&$("#contextMenu").remove()});var o=function(){var e=s,n=new Array,r=["Telephone","Mobile Phone","Phone","Mphone"];for(i=0;i<t.fnSettings().aoColumns.length;i++)n[i]=t.fnSettings().aoColumns[i].sTitle;var o="<div id='custom_modal'>";for(i=0;i<e.length-1;i++)o+="<div><span class='modal_head'>"+n[i]+"</span>",o+="<span class='modal_data'>",n[i]=="E-mail"||n[i]=="Email"?o+="<a href='mailto:"+e[i]+"'>"+e[i]+"</a>":$.inArray(n[i],r)!=-1?o+="<a href='tel:"+e[i]+"'>"+e[i]+"</a>":o+=e[i],o+="</span></div>";o+="</div>",$("#modal").html(o).dialog({modal:!0,title:"Informations user #"+e[0],hide:{effect:"drop",direction:"right"},minWidth:700,show:{effect:"drop",direction:"left"}})};$(document).on("focus","#min:not(.hasDatepicker), #max:not(.hasDatepicker)",function(){$.datepicker._gotoToday=function(e){var t=$(e),n=this._getInst(t[0]);if(this._get(n,"gotoCurrent")&&n.currentDay)n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear;else{var r=new Date;n.selectedDay=r.getDate(),n.drawMonth=n.selectedMonth=r.getMonth(),n.drawYear=n.selectedYear=r.getFullYear(),this._setDateDatepicker(t,r),this._selectDate(e,this._getDateDatepicker(t))}this._notifyChange(n),this._adjustDate(t)}}),$(document).on("focus","#min:not(.hasDatepicker)",function(){$("#min").datepicker({dateFormat:"yy-mm-dd",showButtonPanel:!0,firstDay:1,showAnim:"slide",maxDate:"0",showOtherMonths:!0,selectOtherMonths:!0,onSelect:function(e){$("#max").datepicker("option","minDate",e),t.fnDraw()}}).on("click",function(){$("#ui-datepicker-div").css({"z-index":"1001"})})}),$(document).on("focus","#max:not(.hasDatepicker)",function(){$("#max").datepicker({dateFormat:"yy-mm-dd",showButtonPanel:!0,firstDay:1,showAnim:"slide",maxDate:"0",showOtherMonths:!0,selectOtherMonths:!0,onSelect:function(e){$("#min").datepicker("option","maxDate",e),t.fnDraw()}}).on("click",function(){$("#ui-datepicker-div").css({"z-index":"1001"})})}),$(".chosen_date").on("change",function(e,n,r){var i=n?n.selected:0,s=Date.today().toString("yyyy-MM-dd");yesterday=Date.parse("yesterday").toString("yyyy-MM-dd"),firstOfCurrentWeek=Date.today().is().monday()?s:Date.today().last().monday().toString("yyyy-MM-dd"),firstOfLastWeek=Date.today().is().monday()?Date.today().last().monday():Date.today().last().monday().add(-7).days().toString("yyyy-MM-dd"),lastOfLastWeek=Date.today().last().sunday().toString("yyyy-MM-dd"),firstOfCurrentMonth=Date.today().clearTime().moveToFirstDayOfMonth().toString("yyyy-MM-dd"),firstOfLastMonth=Date.today().clearTime().moveToFirstDayOfMonth().add(-1).months().toString("yyyy-MM-dd"),lastOfLastMonth=Date.today().clearTime().moveToLastDayOfMonth().add(-1).months().toString("yyyy-MM-dd"),firstOfCurrentYear=Date.parse("1st january").toString("yyyy-MM-dd"),firstOfLastYear=Date.parse("1st january").add(-1).year().toString("yyyy-MM-dd"),lastOfLastYear=Date.parse("31st december").add(-1).year().toString("yyyy-MM-dd");switch(i){case"today":$("#min, #max").val(s);break;case"yesterday":$("#min, #max").val(yesterday);break;case"week":$("#min").val(firstOfCurrentWeek),$("#max").val(s);break;case"lastWeek":$("#min").val(firstOfLastWeek),$("#max").val(lastOfLastWeek);break;case"month":$("#min").val(firstOfCurrentMonth),$("#max").val(s);break;case"lastMonth":$("#min").val(firstOfLastMonth),$("#max").val(lastOfLastMonth);break;case"year":$("#min").val(firstOfCurrentMonth),$("#max").val(s);break;case"lastYear":$("#min").val(firstOfLastYear),$("#max").val(lastOfLastYear);break;default:$("#min, #max").val("")}t.fnDraw()}),$("#grid tbody").on("contextmenu","tr td",function(e){$("#contextMenu").length>0&&$("#contextMenu").remove();var t=document.elementFromPoint(e.clientX,e.clientY),n=$(t).closest("tr"),r=n.prop("id"),i=$(this).index(),s=$(this).closest("tbody").siblings("thead").find("th").eq(i).text(),o=$(document.createElement("div")).html("User with "+s+": "+$(t).text()),u=$(document.createElement("div")).html("delete").addClass("delete"),a=$(document.createElement("div")).html("details").addClass("details"),f=$(document.createElement("div")).css({position:"absolute",top:e.pageY-1,left:e.pageX-1,zIndex:1e3}).prop("id","contextMenu").addClass("contextMenu effect1").data("id",r).append(o).append(a).appendTo("body");return canDelete&&table!="all"&&$(contextMenu).append(u),!1}),$(document).on("click",function(){$("#contextMenu").length>0&&$("#contextMenu").remove()}),$("#contextMenu").on("click",function(){e.stopPropagation()})}),!function(e){"use strict";function n(){e(t).parent("li").removeClass("open")}e.fn.dropdown=function(r){return this.each(function(){e(this).delegate(r||t,"click",function(t){var r=e(this).parent("li"),i=r.hasClass("open");return n(),!i&&r.toggleClass("open"),!1})})};var t="a.menu, .dropdown-toggle";e(function(){e("html").bind("click",n),e("body").dropdown("[data-dropdown] a.menu, [data-dropdown] .dropdown-toggle")})}(window.jQuery||window.ender);var wn=window.webkitNotifications,domain=document.domain,maxDisplay=10;typeof localStorage.view=="undefined"&&(localStorage.view=0),localStorage.view++;var still=maxDisplay-localStorage.view;if(!window.WebSocket)still>0&&$.jGrowl("Your browser is outdated, in order to use the live notification please use at least <b>Chrome 6</b> or <b>Firefox 8</b> or <b>Internet Explorer 10</b> or <b>Opera 12.10</b> or <b>Safari 5.0</b>.<br />This message will be displayed "+still+" times",{theme:"information",life:1e4});else{var ws=new WebSocket("ws://"+domain+":8000/server.php");ws.onerror=function(){console.log("error")},ws.onclose=function(){$.jGrowl("Connection to websocket server closed",{theme:"information",life:1e3})},window.webkitNotifications?wn.checkPermission()==0?ws.onmessage=function(e){var t=jQuery.parseJSON(e.data);if(t.text&&t.form){text=sprintf(t.text,t.form);var n=wn.createNotification("http://"+domain+":3000/assets/img/icons/25x25/dark/user.png","Notification From the IKON backoffice",text)}else if(t.form)var n=wn.createNotification("http://"+domain+":3000/assets/img/icons/25x25/dark/computer-imac.png","A new form have been submitted","A user just have submitted a new form in "+t.form);else if(t.name&&t.text)var n=wn.createNotification("http://"+domain+":3000/assets/img/icons/25x25/dark/computer-imac.png","Notification From "+t.name,t.text);window.not=n,n.show(),window.setTimeout(function(){n.cancel()},5e3),n.hasOwnProperty("onclick")&&(n.onclick=function(){this.cancel()})}:(still>0&&$.jGrowl("<a href='#' onclick=allowNotification(); return false;>Allow the webkitNotification on your browser</a>",{theme:"information",life:1e4}),ws.onmessage=function(e){var t=jQuery.parseJSON(e.data),n="";t.text&&t.url&&t.form?n=sprintf(t.text,t.form)+' <a href="'+t.url+'">Click here</a>':t.form&&t.url?n='New registration in the <a href="'+t.url+'">'+t.form+"</a> form":t.name&&t.text&&(n=t.name+" sent a notification: "+t.text),$.jGrowl(n,{theme:"information",life:1e4})}):(localStorage.view<maxDisplay&&$.jGrowl("Notification only works on <b>Chrome</b> from the <b>version 6</b>.<br />This message will be displayed "+still+" times",{theme:"information",life:1e4}),ws.onmessage=function(e){var t=jQuery.parseJSON(e.data);t.text&&t.url&&t.form?text=sprintf(t.text,t.form)+' <a href="'+t.url+'">Click here</a>':t.name&&t.text?text=t.name+" sent a notification: "+t.text:text="",$.jGrowl(text,{theme:"information",life:1e4})})}var allowNotification=function(){allowed=wn.requestPermission(),allowed&&wn.createNotification("http://192.168.1.214:3000/assets/img/icons/16x16/user.png","info","Notification allowed for the IKON backoffice")},fs=function(){$.jGrowl("You are now in fullscreen Mode, to quit it press <b>ESC</b> on your keyboard",{theme:"information",life:1e4}),document.documentElement.webkitRequestFullscreen?document.documentElement.webkitRequestFullscreen():document.documentElement.RequestFullscreen?document.documentElement.RequestFullscreen():document.documentElement.mozRequestFullScreen&&document.documentElement.mozRequestFullScreen()};(document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.fullScreenEnabled)&&$.jGrowl("<a href='#' onclick='fs(); return false;'>Fullscreen</a>",{theme:"information",life:3e3}),window.log=function(){log.history=log.history||[],log.history.push(arguments);if(this.console){arguments.callee=arguments.callee.caller;var e=[].slice.call(arguments);typeof console.log=="object"?log.apply.call(console.log,console,e):console.log.apply(console,e)}},function(e){function t(){}for(var n="assert,clear,count,debug,dir,dirxml,error,exception,firebug,group,groupCollapsed,groupEnd,info,log,memoryProfile,memoryProfileEnd,profile,profileEnd,table,time,timeEnd,timeStamp,trace,warn".split(","),r;r=n.pop();)e[r]=e[r]||t}(function(){try{return console.log(),window.console}catch(e){return window.console={}}}()),jQuery.fn.initMenu=function(){return $(this).each(function(){var e=$(this);e.find(".sub").show(),e.parent().height(e.height()+10),e.find(".sub").hide(),e.find("li:has(ul)").each(function(){$(this).children("a").append("<span class='arrow'>&raquo;</span>")}),e.find(".sub").hide(),e.find("li a").click(function(t){t.stopImmediatePropagation();var n=$(this).next(),r=$(this);if(e.hasClass("noaccordion"))return n.length==0&&(window.location.href=this.href),n.slideToggle("normal"),!1;if(n.hasClass("sub")&&n.is(":visible"))return e.hasClass("collapsible")?(e.find(".sub:visible").slideUp("normal"),!1):!1;if(n.hasClass("sub")&&!n.is(":visible"))return e.find(".sub:visible").slideUp("normal"),n.slideDown("normal"),!1})})},function(e){e.fn.alertBox=function(t,n){var r=e.extend({},e.fn.alertBox.defaults,n);this.each(function(n){var i=e(this),s="alert "+r.type;r.noMargin&&(s+=" no-margin"),r.position&&(s+=" "+r.position);var o=e('<div style="display:none" class="'+s+' .generated">'+t+"</div>");r.icon&&o.prepend(e("<span>").addClass("icon"));var u=i.prepend(o);e(o).fadeIn()})},e.fn.alertBox.defaults={type:"info",position:"top",noMargin:!0,icon:!1}}(jQuery),function(e){e.fn.removeAlertBoxes=function(){var t=e(this),n=t.find(".alert");n.fadeOut(function(){e(this).remove()})}}(jQuery),function(e){e.fn.createTabs=function(){var t=e(this),n=0;t.find(".tab-content").hide();if(window.location.hash.indexOf("#tab")==0){var r=window.location.hash.substr(1);console.log(r);if(typeof r=="number"){var i=parseInt(window.location.hash.substr(1),10);i>0&&i<t.find(".tab-content").size()&&(n=i-1)}else{var s=t.find("#"+r.replace("tab-","")+".tab-content");s.size()&&s.not(":visible")&&(n=s.index())}}t.find(".header").find("li").eq(n).addClass("current").show(),t.find(".tab-content").eq(n).show(),t.find(".header").find("li").click(function(){t.find(".header").find("li").removeClass("current"),e(this).addClass("current"),t.find(".tab-content").hide();var n=e(this).find("a").attr("href");return e(n).fadeIn(),!1})}}(jQuery),function(e){e.browser.msie&&(window.getComputedStyle||(window.getComputedStyle=function(e,t){return this.el=e,this.getPropertyValue=function(t){var n=/(\-([a-z]){1})/g;return t=="float"&&(t="styleFloat"),n.test(t)&&(t=t.replace(n,function(){return arguments[2].toUpperCase()})),e.currentStyle[t]?e.currentStyle[t]:null},this}));var t=["height","width"];e.each(t,function(){var t=this;e.cssHooks[this+"Exact"]={get:function(e,n,r){return window.getComputedStyle(e)[t]}}})}(jQuery),$(document).ready(function(){});var charts,options={chart:{renderTo:"daily",type:"line",plotBackgroundColor:"#FFFFFF",plotShadow:!0,zoomType:"x",plotBorderWidth:0,height:700,animation:{duration:1e3},theme:{fill:"white",stroke:"#bbbbbb",r:5,states:{hover:{fill:"#41739D",style:{color:"white"}}}}},yAxis:{min:0,startOnTick:!1},title:{text:"Registration tracking"},exporting:{filename:"ikon-chart"},plotOptions:{series:{cursor:"pointer",events:{click:function(e){if(!this.visible)return!0;var t=this.index,n=this.chart.series;for(var r=0;r<n.length;r++)n[r].index!=t&&(n[r].visible?n[r].hide():n[r].show());return!1}}}},tooltip:{formatter:function(){return"<b>"+this.series.name+"</b><br/>"+Date.parse(Highcharts.dateFormat("%B %Y",this.x)).add(1).month().toString("MMMM yyyy")+": "+this.y+" registrations"}},series:[],xAxis:{type:"datetime",labels:{rotation:-45,align:"right",style:{font:"normal 13px Verdana, sans-serif"}}},credits:{enabled:!1},yAxis:{title:{text:"Registrations"},plotLines:[{value:0,width:1,color:"#808080"}]}};$.ajax({url:"/ajax/charts/daily",success:function(e){$.each(e,function(e,t){options.series.push(t)}),charts=new Highcharts.Chart(options)}}),$(".");